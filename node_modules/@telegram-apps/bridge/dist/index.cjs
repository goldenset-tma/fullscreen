"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var E;function Te(t){return{lang:(t==null?void 0:t.lang)??(E==null?void 0:E.lang),message:t==null?void 0:t.message,abortEarly:(t==null?void 0:t.abortEarly)??(E==null?void 0:E.abortEarly),abortPipeEarly:(t==null?void 0:t.abortPipeEarly)??(E==null?void 0:E.abortPipeEarly)}}var O;function vt(t){return O==null?void 0:O.get(t)}var J;function gt(t){return J==null?void 0:J.get(t)}var z;function wt(t,e){var n;return(n=z==null?void 0:z.get(t))==null?void 0:n.get(e)}function Et(t){var n,r;const e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&((r=(n=Object.getPrototypeOf(t))==null?void 0:n.constructor)==null?void 0:r.name))??"null":e}function j(t,e,n,r,s){const a=s&&"input"in s?s.input:n.value,o=(s==null?void 0:s.expected)??t.expects??null,u=(s==null?void 0:s.received)??Et(a),i={kind:t.kind,type:t.type,input:a,expected:o,received:u,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${u}`,requirement:t.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=t.kind==="schema",p=(s==null?void 0:s.message)??t.message??wt(t.reference,i.lang)??(c?gt(i.lang):null)??r.message??vt(i.lang);p&&(i.message=typeof p=="function"?p(i):p),c&&(n.typed=!1),n.issues?n.issues.push(i):n.issues=[i]}function w(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},Te())}}}function kt(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}var xt=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function re(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function C(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function Ie(){return{kind:"schema",type:"any",reference:Ie,expects:"any",async:!1,get"~standard"(){return w(this)},"~run"(t){return t.typed=!0,t}}}function F(t){return{kind:"schema",type:"boolean",reference:F,expects:"boolean",async:!1,message:t,get"~standard"(){return w(this)},"~run"(e,n){return typeof e.value=="boolean"?e.typed=!0:j(this,"type",e,n),e}}}function se(t){return{kind:"schema",type:"function",reference:se,expects:"Function",async:!1,message:t,get"~standard"(){return w(this)},"~run"(e,n){return typeof e.value=="function"?e.typed=!0:j(this,"type",e,n),e}}}function g(t,e){return{kind:"schema",type:"loose_object",reference:g,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return w(this)},"~run"(n,r){var a;const s=n.value;if(s&&typeof s=="object"){n.typed=!0,n.value={};for(const o in this.entries){const u=this.entries[o];if(o in s||(u.type==="exact_optional"||u.type==="optional"||u.type==="nullish")&&u.default!==void 0){const i=o in s?s[o]:re(u),c=u["~run"]({value:i},r);if(c.issues){const p={type:"object",origin:"value",input:s,key:o,value:i};for(const l of c.issues)l.path?l.path.unshift(p):l.path=[p],(a=n.issues)==null||a.push(l);if(n.issues||(n.issues=c.issues),r.abortEarly){n.typed=!1;break}}c.typed||(n.typed=!1),n.value[o]=c.value}else if(u.type!=="exact_optional"&&u.type!=="optional"&&u.type!=="nullish"&&(j(this,"key",n,r,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:s,key:o,value:s[o]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const o in s)kt(s,o)&&!(o in this.entries)&&(n.value[o]=s[o])}else j(this,"type",n,r);return n}}}function T(t,e){return{kind:"schema",type:"nullish",reference:T,expects:`(${t.expects} | null | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return w(this)},"~run"(n,r){return(n.value===null||n.value===void 0)&&(this.default!==void 0&&(n.value=re(this,n,r)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function K(t){return{kind:"schema",type:"number",reference:K,expects:"number",async:!1,message:t,get"~standard"(){return w(this)},"~run"(e,n){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:j(this,"type",e,n),e}}}function Y(t,e){return{kind:"schema",type:"optional",reference:Y,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return w(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=re(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function k(t){return{kind:"schema",type:"string",reference:k,expects:"string",async:!1,message:t,get"~standard"(){return w(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:j(this,"type",e,n),e}}}function Le(){return{kind:"schema",type:"unknown",reference:Le,expects:"unknown",async:!1,get"~standard"(){return w(this)},"~run"(t){return t.typed=!0,t}}}function H(t,e,n){const r=t["~run"]({value:e},Te(n));if(r.issues)throw new xt(r.issues);return r.value}function Re(...t){return{...t[0],pipe:t,get"~standard"(){return w(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}function oe(t){return C(g({TelegramWebviewProxy:g({postEvent:se()})}),t)}function ae(){try{return window.self!==window.top}catch{return!0}}var Pt=Object.defineProperty,$t=(t,e,n)=>e in t?Pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Q=(t,e,n)=>$t(t,typeof e!="symbol"?e+"":e,n);function St(t){return e=>e instanceof t}function Ue(t,e){e||(e=[]);class n extends Error{constructor(...s){const a=typeof e=="function"?e(...s):typeof e=="string"?[e]:e||[];super(...a),this.name=t}}return Object.defineProperty(n,"name",{value:t}),[n,St(n)]}const[Ce,At]=Ue("CancelledError","Promise was canceled"),[De,jt]=Ue("TimeoutError",(t,e)=>[`Timeout reached: ${t}ms`,{cause:e}]),We=Symbol("Resolved");function we(t){return Array.isArray(t)&&t[0]===We}function Mt(t){return[We,t]}function Ee(t,e){return t.reject=e.reject,t.abort=e.abort,t}let D=class Z extends Promise{constructor(e,n){let r,s;super((a,o)=>{let u,i;typeof e=="function"?(u=e,i=n):i=e;const c=[],p=f=>(...A)=>{const L=f(...A);return c.forEach(mt=>mt()),L},l=new AbortController,{signal:_}=l;s=f=>{!_.aborted&&l.abort(f)};const h=()=>_.reason,$=f=>{const A=()=>{f(h())};_.addEventListener("abort",A,!0);const L=()=>{_.removeEventListener("abort",A,!0)};return c.push(L),L},bt=p(f=>{a(f),s(Mt(f))});r=p(f=>{o(f),s(f)}),i||(i={});const{abortSignal:S,rejectOnAbort:be=!0}=i;if(S)if(S.aborted){const{reason:f}=S;if(be)return r(f);s(f)}else{const f=()=>{s(S.reason)};S.addEventListener("abort",f),c.push(()=>{S.removeEventListener("abort",f)})}be&&$(o);const{timeout:N}=i;if(N){const f=setTimeout(()=>{s(new De(N))},N);c.push(()=>{clearTimeout(f)})}const me=()=>_.aborted,ve=()=>we(h()),ge=()=>{const f=h();return we(f)?f[1]:void 0};try{const f=u&&u(bt,r,{abortReason:h,abortSignal:_,isAborted:me,isResolved:ve,onAborted:$,onResolved:A=>$(()=>{ve()&&A(ge())}),resolved:ge,throwIfAborted(){if(me())throw h()}});f instanceof Promise&&f.catch(r)}catch(f){r(f)}}),Q(this,"abort"),Q(this,"reject"),this.abort=s,this.reject=r}static fn(e,n){return new Z(async(r,s,a)=>{try{r(await e(a))}catch(o){s(o)}},n)}static resolve(e){return this.fn(()=>e)}static reject(e){return new Z((n,r)=>{r(e)})}cancel(){this.abort(new Ce)}catch(e){return this.then(void 0,e)}finally(e){return Ee(super.finally(e),this)}then(e,n){return Ee(super.then(e,n),this)}};function ke(t,e){return t.resolve=e.resolve,t}let qt=class X extends D{constructor(e,n){let r,s;typeof e=="function"?(r=e,s=n):s=e;let a;super((o,u,i)=>{a=o,r&&r(o,u,i)},s),Q(this,"resolve"),this.resolve=a}static fn(e,n){return new X((r,s,a)=>{try{Promise.resolve(e(a)).then(r,s)}catch(o){s(o)}},n)}static resolve(e){return this.fn(()=>e)}static reject(e){return new X((n,r)=>{r(e)})}catch(e){return this.then(void 0,e)}finally(e){return ke(super.finally(e),this)}then(e,n){return ke(super.then(e,n),this)}};function Tt(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function It(t){return Object.entries(t).reduce((e,[n,r])=>(e[Tt(n)]=r,e),{})}function V(t){const e=It(t);for(const n in e){const r=e[n];r&&typeof r=="object"&&!(r instanceof Date)&&(e[n]=Array.isArray(r)?r.map(V):V(r))}return e}function Ne(t){return`tapps/${t}`}function Oe(t,e){sessionStorage.setItem(Ne(t),JSON.stringify(e))}function Lt(t){const e=sessionStorage.getItem(Ne(t));try{return e?JSON.parse(e):void 0}catch{}}function Rt(...t){const e=t.flat(1);return[e.push.bind(e),()=>{e.forEach(n=>{n()})}]}function Ut(t,e){e||(e={});const{textColor:n,bgColor:r,shouldLog:s}=e,a=s===void 0?!0:s,o=typeof a=="boolean"?()=>a:a;function u(i,c,...p){if(c||o()){const l="font-weight:bold;padding:0 5px;border-radius:5px";console[i](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${t}`,`${l};background-color: lightblue;color:black`,"",`${l};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...p)}}return[u.bind(void 0,"log"),u.bind(void 0,"error")]}function Je(t){return{lang:(t==null?void 0:t.lang)??void 0,message:t==null?void 0:t.message,abortEarly:(t==null?void 0:t.abortEarly)??void 0,abortPipeEarly:(t==null?void 0:t.abortPipeEarly)??void 0}}function Ct(t,e){var n;return(n=void 0)==null?void 0:n.get(e)}function Dt(t){var e,n;const r=typeof t;return r==="string"?`"${t}"`:r==="number"||r==="bigint"||r==="boolean"?`${t}`:r==="object"||r==="function"?(t&&((n=(e=Object.getPrototypeOf(t))==null?void 0:e.constructor)==null?void 0:n.name))??"null":r}function m(t,e,n,r,s){const a=s&&"input"in s?s.input:n.value,o=(s==null?void 0:s.expected)??t.expects??null,u=(s==null?void 0:s.received)??Dt(a),i={kind:t.kind,type:t.type,input:a,expected:o,received:u,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${u}`,requirement:t.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=t.kind==="schema",p=(s==null?void 0:s.message)??t.message??Ct(t.reference,i.lang)??(c?(i.lang,void 0):null)??r.message??(i.lang,void 0);p&&(i.message=typeof p=="function"?p(i):p),c&&(n.typed=!1),n.issues?n.issues.push(i):n.issues=[i]}function v(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},Je())}}}function ze(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Wt(t,e){const n=[...new Set(t)];return n.length>1?`(${n.join(` ${e} `)})`:n[0]??"never"}var Nt=class extends Error{constructor(t){super(t[0].message),this.name="ValiError",this.issues=t}};function Ge(t,e){return{kind:"validation",type:"check",reference:Ge,async:!1,expects:null,requirement:t,message:e,"~run"(n,r){return n.typed&&!this.requirement(n.value)&&m(this,"input",n,r),n}}}function Be(t){return{kind:"validation",type:"integer",reference:Be,async:!1,expects:null,requirement:Number.isInteger,message:t,"~run"(e,n){return e.typed&&!this.requirement(e.value)&&m(this,"integer",e,n),e}}}function x(t){return{kind:"transformation",type:"transform",reference:x,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function Fe(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function Ot(t,e){return!t["~run"]({value:e},{abortEarly:!0}).issues}function I(t){return{kind:"schema",type:"boolean",reference:I,expects:"boolean",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="boolean"?e.typed=!0:m(this,"type",e,n),e}}}function Ke(t){return{kind:"schema",type:"date",reference:Ke,expects:"Date",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return e.value instanceof Date?isNaN(e.value)?m(this,"type",e,n,{received:'"Invalid Date"'}):e.typed=!0:m(this,"type",e,n),e}}}function Ye(t,e){return{kind:"schema",type:"instance",reference:Ye,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){return n.value instanceof this.class?n.typed=!0:m(this,"type",n,r),n}}}function ie(t){return{kind:"schema",type:"lazy",reference:ie,expects:"unknown",async:!1,getter:t,get"~standard"(){return v(this)},"~run"(e,n){return this.getter(e.value)["~run"](e,n)}}}function M(t,e){return{kind:"schema",type:"loose_object",reference:M,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){var s;const a=n.value;if(a&&typeof a=="object"){n.typed=!0,n.value={};for(const o in this.entries){const u=this.entries[o];if(o in a||(u.type==="exact_optional"||u.type==="optional"||u.type==="nullish")&&u.default!==void 0){const i=o in a?a[o]:Fe(u),c=u["~run"]({value:i},r);if(c.issues){const p={type:"object",origin:"value",input:a,key:o,value:i};for(const l of c.issues)l.path?l.path.unshift(p):l.path=[p],(s=n.issues)==null||s.push(l);if(n.issues||(n.issues=c.issues),r.abortEarly){n.typed=!1;break}}c.typed||(n.typed=!1),n.value[o]=c.value}else if(u.type!=="exact_optional"&&u.type!=="optional"&&u.type!=="nullish"&&(m(this,"key",n,r,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:a,key:o,value:a[o]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const o in a)ze(a,o)&&!(o in this.entries)&&(n.value[o]=a[o])}else m(this,"type",n,r);return n}}}function W(t){return{kind:"schema",type:"number",reference:W,expects:"number",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:m(this,"type",e,n),e}}}function y(t,e){return{kind:"schema",type:"optional",reference:y,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return v(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=Fe(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function He(t,e,n){return{kind:"schema",type:"record",reference:He,expects:"Object",async:!1,key:t,value:e,message:n,get"~standard"(){return v(this)},"~run"(r,s){var a,o;const u=r.value;if(u&&typeof u=="object"){r.typed=!0,r.value={};for(const i in u)if(ze(u,i)){const c=u[i],p=this.key["~run"]({value:i},s);if(p.issues){const _={type:"object",origin:"key",input:u,key:i,value:c};for(const h of p.issues)h.path=[_],(a=r.issues)==null||a.push(h);if(r.issues||(r.issues=p.issues),s.abortEarly){r.typed=!1;break}}const l=this.value["~run"]({value:c},s);if(l.issues){const _={type:"object",origin:"value",input:u,key:i,value:c};for(const h of l.issues)h.path?h.path.unshift(_):h.path=[_],(o=r.issues)==null||o.push(h);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}(!p.typed||!l.typed)&&(r.typed=!1),p.typed&&(r.value[p.value]=l.value)}}else m(this,"type",r,s);return r}}}function d(t){return{kind:"schema",type:"string",reference:d,expects:"string",async:!1,message:t,get"~standard"(){return v(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:m(this,"type",e,n),e}}}function xe(t){let e;if(t)for(const n of t)e?e.push(...n.issues):e=n.issues;return e}function ue(t,e){return{kind:"schema",type:"union",reference:ue,expects:Wt(t.map(n=>n.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return v(this)},"~run"(n,r){let s,a,o;for(const u of this.options){const i=u["~run"]({value:n.value},r);if(i.typed)if(i.issues)a?a.push(i):a=[i];else{s=i;break}else o?o.push(i):o=[i]}if(s)return s;if(a){if(a.length===1)return a[0];m(this,"type",n,r,{issues:xe(a)}),n.typed=!0}else{if((o==null?void 0:o.length)===1)return o[0];m(this,"type",n,r,{issues:xe(o)})}return n}}}function Qe(){return{kind:"schema",type:"unknown",reference:Qe,expects:"unknown",async:!1,get"~standard"(){return v(this)},"~run"(t){return t.typed=!0,t}}}function Ze(t,e,n){const r=t["~run"]({value:e},Je(n));if(r.issues)throw new Nt(r.issues);return r.value}function P(...t){return{...t[0],pipe:t,get"~standard"(){return v(this)},"~run"(e,n){for(const r of t)if(r.kind!=="metadata"){if(e.issues&&(r.kind==="schema"||r.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=r["~run"](e,n))}return e}}}function Jt(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}function zt(t){return Object.entries(t).reduce((e,[n,r])=>(e[Jt(n)]=r,e),{})}function ee(t){const e=zt(t);for(const n in e){const r=e[n];r&&typeof r=="object"&&!(r instanceof Date)&&(e[n]=Array.isArray(r)?r.map(ee):ee(r))}return e}function ce(t){return x(e=>t?ee(e):e)}function Xe(t){return e=>P(t,ce(e))}function Gt(t){return(e,n)=>Ze(P(t,ce(n)),e)}function pe(){return x(JSON.parse)}function le(t){const e=Xe(t);return n=>P(d(),pe(),e(n))}function Bt(t){return x(e=>{const n={};return new URLSearchParams(e).forEach((r,s)=>{const a=n[s];Array.isArray(a)?a.push(r):a===void 0?n[s]=r:n[s]=[a,r]}),Ze(t,n)})}function Ve(t){return e=>P(ue([d(),Ye(URLSearchParams)]),Bt(t),ce(e))}const Pe=y(ie(()=>Qt())),Ft=M({id:W(),photo_url:y(d()),type:d(),title:d(),username:y(d())}),Kt=M({added_to_attachment_menu:y(I()),allows_write_to_pm:y(I()),first_name:d(),id:W(),is_bot:y(I()),is_premium:y(I()),last_name:y(d()),language_code:y(d()),photo_url:y(d()),username:y(d())}),Yt=M({auth_date:P(d(),x(t=>new Date(Number(t)*1e3)),Ke()),can_send_after:y(P(d(),x(Number),Be())),chat:y(ie(()=>Ht())),chat_type:y(d()),chat_instance:y(d()),hash:d(),query_id:y(d()),receiver:Pe,start_param:y(d()),signature:d(),user:Pe}),Ht=le(Ft),Qt=le(Kt),Zt=Ve(Yt);function Xt(t){return/^#[\da-f]{6}$/i.test(t)}const et=Xe(He(d(),P(ue([d(),W()]),x(t=>typeof t=="number"?`#${(t&16777215).toString(16).padStart(6,"0")}`:t),Ge(Xt)))),G=y(P(d(),x(t=>t==="1"))),$e=le(et()),Vt=M({tgWebAppBotInline:G,tgWebAppData:y(Zt()),tgWebAppDefaultColors:y($e()),tgWebAppFullscreen:G,tgWebAppPlatform:d(),tgWebAppShowSettings:G,tgWebAppStartParam:y(d()),tgWebAppThemeParams:$e(),tgWebAppVersion:d()}),tt=Ve(Vt),en=Gt(tt()),nt=M({eventType:d(),eventData:y(Qe())});function rt(t,e){return e||(e=(n,r)=>JSON.stringify(r)),new URLSearchParams(Object.entries(t).reduce((n,[r,s])=>(Array.isArray(s)?n.push(...s.map(a=>[r,String(a)])):s!=null&&n.push([r,s instanceof Date?(s.getTime()/1e3|0).toString():typeof s=="string"||typeof s=="number"?String(s):typeof s=="boolean"?s?"1":"0":e(r,s)]),n),[])).toString()}function tn(t){return rt(t)}function nn(t){return rt(t,(e,n)=>e==="tgWebAppData"?tn(n):JSON.stringify(n))}function st(t){try{return Ot(tt(),t)}catch{return!1}}function rn(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}}function sn(t,e){const n=rn(),r=new Map,s=(a,o,u)=>{u||(u=!1);const i=r.get(a)||new Map;r.set(a,i);const c=i.get(o)||[];i.set(o,c);const p=c.findIndex(l=>l[1]===u);p>=0&&(n.off(a,c[p][0]),c.splice(p,1),!c.length&&i.delete(o),i.size||(r.delete(a),!r.size&&e()))};return[function(o,u,i){!r.size&&t();function c(){s(o,u,i)}function p(...h){i&&c(),o==="*"?u(h):u(...h)}n.on(o,p);const l=r.get(o)||new Map;r.set(o,l);const _=l.get(u)||[];return l.set(u,_),_.push([p,i||!1]),c},s,n.emit,function(){const o=n.all.size;n.all.clear(),r.clear(),o&&e()}]}function te(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}let R=!1;const[fe,on]=Ut("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return R}}),Se=t=>{fe(!1,"Event received:",t)};function ot(t){t!==R&&(R=t,R?de("*",Se):at("*",Se))}const an={clipboard_text_received:g({req_id:k(),data:T(k())}),custom_method_invoked:g({req_id:k(),result:Y(Le()),error:Y(k())}),popup_closed:T(g({button_id:T(k(),()=>{})}),{}),viewport_changed:g({height:K(),width:T(K(),()=>window.innerWidth),is_state_stable:F(),is_expanded:F()}),theme_changed:g({theme_params:et()})};function Ae(t){if(t.source!==window.parent)return;let e;try{e=H(Re(k(),pe(),nt),t.data)}catch{return}const{eventType:n,eventData:r}=e,s=an[n];try{const a=s?H(s,r):r;un(n,a)}catch(a){on(!0,[`An error occurred processing the "${n}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),e,a)}}const[de,at,un,it]=sn(()=>{const t=window,e={receiveEvent:te};t.TelegramGameProxy_receiveEvent=te,t.TelegramGameProxy=e,t.Telegram={WebView:e},window.addEventListener("message",Ae)},()=>{["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(t=>{delete window[t]}),window.removeEventListener("message",Ae)});function cn(t){return e=>e instanceof t}function q(t,e){e||(e=[]);class n extends Error{constructor(...s){const a=typeof e=="function"?e(...s):typeof e=="string"?[e]:e||[];super(...a),this.name=t}}return Object.defineProperty(n,"name",{value:t}),[n,cn(n)]}const[ut,pn]=q("MethodUnsupportedError",(t,e)=>[`Method "${t}" is unsupported in Mini Apps version ${e}`]),[ct,ln]=q("MethodParameterUnsupportedError",(t,e,n)=>[`Parameter "${e}" of "${t}" method is unsupported in Mini Apps version ${n}`]),fn=["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment"].join(`
`),[pt,dn]=q("LaunchParamsRetrieveError",fn),[lt,yn]=q("InvalidLaunchParamsError",t=>[`Invalid value for launch params: ${t}`]),[ft,_n]=q("UnknownEnvError"),[dt,hn]=q("InvokeCustomMethodError",t=>[`Server returned error: ${t}`]);function bn(t,e){e()}function mn(t,e){e||(e={});const n=e.equals||Object.is;let r=[],s=t;const a=c=>{if(!n(s,c)){const p=s;s=c,bn(i,()=>{[...r].forEach(([l,_])=>{l(c,p),_&&u(l,!0)})})}};function o(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const u=(c,p)=>{const l=o(p),_=r.findIndex(([h,$])=>h===c&&$.once===l.once&&$.signal===l.signal);_>=0&&r.splice(_,1)},i=Object.assign(function(){return vn(i),s},{destroy(){r=[]},set:a,reset(){a(t)},sub(c,p){return r.push([c,o(p)]),()=>u(c,p)},unsub:u,unsubAll(){r=r.filter(c=>c[1].signal)}});return i}const B=[];function vn(t){B.length&&B[B.length-1].add(t)}const U=mn("https://web.telegram.org");function ye(t,e){fe(!1,"Posting event:",e?{eventType:t,eventData:e}:{eventType:t});const n=window,r=JSON.stringify({eventType:t,eventData:e});if(ae())return n.parent.postMessage(r,U());if(oe(n)){n.TelegramWebviewProxy.postEvent(t,JSON.stringify(e));return}if(C(g({external:g({notify:se()})}),n)){n.external.notify(r);return}throw new ft}function _e(t,e,n){n||(n={});const{capture:r}=n,[s,a]=Rt();return new D(o=>{(Array.isArray(e)?e:[e]).forEach(u=>{s(de(u,i=>{(!r||(Array.isArray(e)?r({event:u,payload:i}):r(i)))&&o(i)}))}),(n.postEvent||ye)(t,n.params)},n).finally(a)}const je="launchParams";function Me(t){return t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function he(){for(const t of[()=>Me(window.location.href),()=>{const e=performance.getEntriesByType("navigation")[0];return e&&Me(e.name)},()=>Lt(je)]){const e=t();if(e&&st(e))return Oe(je,e),e}throw new pt}function yt(t){const e=en(he());return t?V(e):e}function gn(t,e){if(!t)try{return yt(),!0}catch{return!1}return D.fn(async n=>{if(oe(window))return!0;try{return await _e("web_app_request_theme","theme_changed",n),!0}catch{return!1}},e||{timeout:100})}function wn({launchParams:t,onEvent:e}={}){if(t){const s=typeof t=="string"||t instanceof URLSearchParams?t.toString():nn({...t,tgWebAppData:void 0})+(t.tgWebAppData?`&tgWebAppData=${encodeURIComponent(t.tgWebAppData.toString())}`:"");if(!st(s))throw new lt(s);Oe("launchParams",s)}if(ae()){const s=Re(k(),pe(),nt),a=window.parent.postMessage.bind(window.parent);window.parent.postMessage=(...o)=>{const[u]=o,i=()=>{a(...o)};if(C(s,u)&&e){const c=H(s,u);e([c.eventType,c.eventData],i)}else i()};return}const n=window.TelegramWebviewProxy||{},{postEvent:r}=n;window.TelegramWebviewProxy={...n,postEvent(s,a){const o=()=>{r&&r(s,a)};e?e([s,a?JSON.parse(a):void 0],o):o()}},fe(!1,"Environment was mocked by the mockTelegramEnv function")}function En(){return new URLSearchParams(he()).get("tgWebAppData")||void 0}function _t(t){return({req_id:e})=>e===t}function qe(t){return t.split(".").map(Number)}function ht(t,e){const n=qe(t),r=qe(e),s=Math.max(n.length,r.length);for(let a=0;a<s;a+=1){const o=n[a]||0,u=r[a]||0;if(o!==u)return o>u?1:-1}return 0}function b(t,e){return ht(t,e)<=0}function ne(t,e,n){if(typeof n=="string"){if(t==="web_app_open_link"){if(e==="try_instant_view")return b("6.4",n);if(e==="try_browser")return b("7.6",n)}if(t==="web_app_set_header_color"&&e==="color")return b("6.9",n);if(t==="web_app_close"&&e==="return_back")return b("7.6",n);if(t==="web_app_setup_main_button"&&e==="has_shine_effect")return b("7.10",n)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return b("6.1",e);case"web_app_open_popup":return b("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return b("6.4",e);case"web_app_switch_inline_query":return b("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return b("6.9",e);case"web_app_setup_settings_button":return b("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return b("7.2",e);case"web_app_setup_swipe_behavior":return b("7.7",e);case"web_app_share_to_story":return b("7.8",e);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return b("7.10",e);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return b("8.0",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function kn(t,e){e||(e="strict");const n=typeof e=="function"?e:r=>{const{method:s,version:a}=r,o="param"in r?new ct(s,r.param,a):new ut(s,a);if(e==="strict")throw o;return console.warn(o.message)};return(r,s)=>ne(r,t)?r==="web_app_set_header_color"&&C(g({color:Ie()}),s)&&!ne(r,"color",t)?n({version:t,method:r,param:"color"}):ye(r,s):n({version:t,method:r})}function xn(t,e,n,r){return _e("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:t,params:e,req_id:n},capture:_t(n)}).then(({result:s,error:a})=>{if(a)throw new dt(a);return s})}function Pn(){it(),ot(!1),U.unsubAll(),U.reset()}exports.AbortablePromise=D;exports.CancelledError=Ce;exports.InvalidLaunchParamsError=lt;exports.InvokeCustomMethodError=dt;exports.LaunchParamsRetrieveError=pt;exports.ManualPromise=qt;exports.MethodParameterUnsupportedError=ct;exports.MethodUnsupportedError=ut;exports.TimeoutError=De;exports.UnknownEnvError=ft;exports.captureSameReq=_t;exports.compareVersions=ht;exports.createPostEvent=kn;exports.emitEvent=te;exports.hasWebviewProxy=oe;exports.invokeCustomMethod=xn;exports.isCancelledError=At;exports.isIframe=ae;exports.isInvalidLaunchParamsError=yn;exports.isInvokeCustomMethodError=hn;exports.isLaunchParamsRetrieveError=dn;exports.isMethodMethodParameterUnsupportedError=ln;exports.isMethodUnsupportedError=pn;exports.isTMA=gn;exports.isTimeoutError=jt;exports.isUnknownEnvError=_n;exports.mockTelegramEnv=wn;exports.off=at;exports.offAll=it;exports.on=de;exports.postEvent=ye;exports.request=_e;exports.resetPackageState=Pn;exports.retrieveLaunchParams=yt;exports.retrieveRawInitData=En;exports.retrieveRawLaunchParams=he;exports.setDebug=ot;exports.supports=ne;exports.targetOrigin=U;
//# sourceMappingURL=index.cjs.map
